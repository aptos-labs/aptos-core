//# publish
module 0x22::A
struct G<T0> has drop + key
  x: T0

public fun make_g(): G<u64>
    ld_u64 1
    pack G<u64>
    ret

public fun store(l0: &signer)
    move_loc l0
    ld_u64 10
    pack G<u64>
    move_to G<u64>
    ret

public fun borrow(l0: address): &G<u64>
    move_loc l0
    borrow_global G<u64>
    ret

public fun borrow_mut(l0: address): &mut u64
    move_loc l0
    mut_borrow_global G<u64>
    ret

public fun borrow_field(l0: address): &u64
    local l1: &G<u64>
    move_loc l0
    borrow_global G<u64>
    st_loc l1
    move_loc l1
    borrow_field G<u64>, x
    ret

public fun borrow_field_2(l0: address): &u64
    local l1: &mut G<u64>
    move_loc l0
    mut_borrow_global G<u64>
    st_loc l1
    move_loc l1
    freeze_ref
    borrow_field G<u64>, x
    ret

public fun borrow_field_mut(l0: address): &mut u64
    local l1: &mut G<u64>
    move_loc l0
    mut_borrow_global G<u64>
    st_loc l1
    move_loc l1
    mut_borrow_field G<u64>, x
    ret



//# run --signers 0x1
script
use 0x22::A
use 0x1::signer
entry public fun main(l0: signer)
    local l1: address
    borrow_loc l0
    call signer::address_of
    st_loc l1
    borrow_loc l0
    call A::store
    ret



//# run --signers 0x1
script
use 0x22::A
use 0x1::signer
entry public fun main(l0: signer)
    local l1: address
    local l2: &A::G<u64>
    local l3: A::G<u64>
    borrow_loc l0
    call signer::address_of
    st_loc l1
    move_loc l1
    call A::borrow
    st_loc l2
    move_loc l2
    read_ref
    st_loc l3
    ret



//# run --signers 0x1
script
use 0x22::A
use 0x1::signer
entry public fun main(l0: signer)
    local l1: address
    local l2: &A::G<u64>
    local l3: A::G<u64>
    borrow_loc l0
    call signer::address_of
    st_loc l1
    move_loc l1
    call A::borrow
    st_loc l2
    call A::make_g
    st_loc l3
    move_loc l3
    move_loc l2
    write_ref
    ret



//# run --signers 0x1
script
use 0x22::A
use 0x1::signer
entry public fun main(l0: signer)
    local l1: address
    local l2: &u64
    local l3: u64
    borrow_loc l0
    call signer::address_of
    st_loc l1
    move_loc l1
    call A::borrow_field
    st_loc l2
    move_loc l2
    read_ref
    st_loc l3
    ret



//# run --signers 0x1
script
use 0x22::A
use 0x1::signer
entry public fun main(l0: signer)
    local l1: address
    local l2: &u64
    local l3: u64
    borrow_loc l0
    call signer::address_of
    st_loc l1
    move_loc l1
    call A::borrow_field_2
    st_loc l2
    move_loc l2
    read_ref
    st_loc l3
    ret



//# run --signers 0x1
script
use 0x22::A
use 0x1::signer
entry public fun main(l0: signer)
    local l1: address
    local l2: &u64
    borrow_loc l0
    call signer::address_of
    st_loc l1
    move_loc l1
    call A::borrow_field
    st_loc l2
    ld_u64 10
    move_loc l2
    write_ref
    ret



//# run --signers 0x1
script
use 0x22::A
use 0x1::signer
entry public fun main(l0: signer)
    local l1: address
    local l2: &mut u64
    borrow_loc l0
    call signer::address_of
    st_loc l1
    move_loc l1
    call A::borrow_field_mut
    st_loc l2
    ld_u64 10
    move_loc l2
    write_ref
    ret
