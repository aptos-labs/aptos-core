//# publish
module 0x22::A
struct C
  x: u64

struct D
  x: u64

public fun make_c(): C
    ld_u64 0
    pack C
    ret

public fun make_d(): D
    ld_u64 0
    pack D
    ret

public fun take_c(l0: C)
    local l1: u64
    move_loc l0
    unpack C
    st_loc l1



//# publish
module 0x22::B
use 0x22::A
struct C
  x: A::C

public fun store(l0: &signer)
    local l1: A::D
    local l2: C
    local l3: A::C
    call A::make_d
    st_loc l1
    move_loc l1
    pack C
    st_loc l2
    move_loc l2
    unpack C
    st_loc l3
    move_loc l3
    call A::take_c
    ret



//# run --signers 0x1
script
use 0x22::B
entry public fun main(l0: signer)
    borrow_loc l0
    call B::store
    ret
