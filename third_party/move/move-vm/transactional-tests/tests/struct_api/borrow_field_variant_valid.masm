//# publish --print-bytecode
module 0x66::test_borrow_field_variant_valid

enum Color has drop
  Red
    r: u8
  Green
    g: u16
  Blue
    b: u8

// In this enum:
// - offset 0 with type u8 appears first (Red.r), gets type_order 0
// - offset 0 with type u16 appears next (Green.g), gets type_order 1
// Note: Blue.b has offset 0 and type u8, but since (0, u8) was already assigned order 0, it doesn't get a new order

// Valid: borrow$Color$0$0 borrows u8 field at offset 0 (Red.r or Blue.b)
#[borrow(0)] public fun borrow$Color$0$0(l0: &Color): &u8
    move_loc l0
    borrow_variant_field Color, Red::r, Blue::b
    ret

// Valid: borrow$Color$0$1 borrows u16 field at offset 0 (Green.g)
#[borrow(0)] public fun borrow$Color$0$1(l0: &Color): &u16
    move_loc l0
    borrow_variant_field Color, Green::g
    ret

// Valid: borrow_mut$Color$0$0 mutably borrows u8 field at offset 0
#[borrow_mut(0)] public fun borrow_mut$Color$0$0(l0: &mut Color): &mut u8
    move_loc l0
    mut_borrow_variant_field Color, Red::r, Blue::b
    ret

// Valid: borrow_mut$Color$0$1 mutably borrows u16 field at offset 0
#[borrow_mut(0)] public fun borrow_mut$Color$0$1(l0: &mut Color): &mut u16
    move_loc l0
    mut_borrow_variant_field Color, Green::g
    ret
