// -- Model dump before first bytecode pipeline
module 0x42::reference_conversion {
    private fun deref(r: &u64): u64 {
        Deref(r)
    }
    private fun use_it(): u64 {
        {
          let x: u64 = 42;
          {
            let r: &mut u64 = Borrow(Mutable)(x);
            r = 43;
            reference_conversion::deref(Freeze(false)(r))
          }
        }
    }
} // end 0x42::reference_conversion

// -- Sourcified model before first bytecode pipeline
module 0x42::reference_conversion {
    fun deref(r: &u64): u64 {
        *r
    }
    fun use_it(): u64 {
        let x = 42;
        let r = &mut x;
        *r = 43;
        deref(r)
    }
}

============ bytecode before first stackless bytecode pipeline ================

[variant baseline]
fun reference_conversion::deref($t0: &u64): u64 {
     var $t1: u64
  0: $t1 := read_ref($t0)
  1: return $t1
}


[variant baseline]
fun reference_conversion::use_it(): u64 {
     var $t0: u64
     var $t1: u64
     var $t2: &mut u64
     var $t3: u64
     var $t4: &u64
  0: $t1 := 42
  1: $t2 := borrow_local($t1)
  2: $t3 := 43
  3: write_ref($t2, $t3)
  4: $t4 := freeze_ref(implicit)($t2)
  5: $t0 := reference_conversion::deref($t4)
  6: return $t0
}

// -- Model dump before second bytecode pipeline
module 0x42::reference_conversion {
    private fun deref(r: &u64): u64 {
        Deref(r)
    }
    private fun use_it(): u64 {
        {
          let x: u64 = 42;
          {
            let r: &mut u64 = Borrow(Mutable)(x);
            r = 43;
            reference_conversion::deref(Freeze(false)(r))
          }
        }
    }
} // end 0x42::reference_conversion

============ bytecode before second stackless bytecode pipeline ================

[variant baseline]
fun reference_conversion::deref($t0: &u64): u64 {
     var $t1: u64
  0: $t1 := read_ref($t0)
  1: return $t1
}


[variant baseline]
fun reference_conversion::use_it(): u64 {
     var $t0: u64
     var $t1: u64
     var $t2: &mut u64
     var $t3: u64
     var $t4: &u64
  0: $t1 := 42
  1: $t2 := borrow_local($t1)
  2: $t3 := 43
  3: write_ref($t2, $t3)
  4: $t4 := freeze_ref(implicit)($t2)
  5: $t0 := reference_conversion::deref($t4)
  6: return $t0
}


============ disassembled file-format ==================
// Bytecode version v10
module 0x42::reference_conversion
// Function definition at index 0
fun deref(l0: &u64): u64
    move_loc l0
    read_ref
    ret

// Function definition at index 1
fun use_it(): u64
    local l0: u64
    local l1: &mut u64
    ld_u64 42
    st_loc l0
    mut_borrow_loc l0
    st_loc l1
    ld_u64 43
    // @5
    copy_loc l1
    write_ref
    move_loc l1
    freeze_ref
    call deref
    // @10
    ret


============ bytecode verification succeeded ========
