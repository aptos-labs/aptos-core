//# publish
module 0x1::M
struct S
  g: u64

fun t1(l0: &mut S, l1: bool)
    local l2: u64
    local l3: u64
    local l4: &u64
    local l5: &u64
    ld_u64 0
    st_loc l2
    ld_u64 1
    st_loc l3
    move_loc l1
    br_true l0
    borrow_loc l2
    st_loc l4
    branch l1
l0: copy_loc l0
    call bar
    st_loc l4
    branch l1
l1: move_loc l0
    borrow_field S, g
    st_loc l5
    ret

fun t2()
    local l0: u64
    local l1: u64
    local l2: &u64
    ld_u64 0
    st_loc l0
    ld_u64 1
    st_loc l1
    borrow_loc l0
    borrow_loc l1
    call foo
    st_loc l2
    borrow_loc l0
    move_loc l2
    call baz
    ret

fun t3()
    local l0: u64
    local l1: u64
    local l2: &u64
    ld_u64 0
    st_loc l0
    ld_u64 1
    st_loc l1
    borrow_loc l0
    borrow_loc l1
    call foo
    st_loc l2
    mut_borrow_loc l0
    freeze_ref
    move_loc l2
    call baz
    ret

fun foo(l0: &u64, l1: &u64): &u64
    local l2: &u64
    copy_loc l0
    read_ref
    copy_loc l1
    read_ref
    gt
    br_true l0
    move_loc l1
    st_loc l2
    move_loc l0
    pop
    branch l1
l0: move_loc l0
    st_loc l2
    move_loc l1
    pop
    branch l1
l1: move_loc l2
    ret

fun bar(l0: &mut S): &u64
    move_loc l0
    borrow_field S, g
    ret

fun baz(l0: &u64, l1: &u64)
    ret