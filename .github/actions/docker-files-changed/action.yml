name: "Check Docker Files Changed"
description: "Checks if any Docker-related files have changed"
inputs:
  base-ref:
    description: "Base branch ref"
    required: false
    default: "movement"
outputs:
  changed:
    description: "true if Docker files changed, false otherwise"
runs:
  using: "composite"
  steps:
  - name: Check if Docker Files Changed
    id: changed
    env:
      BASE_REF: ${{ inputs.base-ref }}
    run: |
      echo "Using base ref: $BASE_REF"
      git fetch origin "$BASE_REF" --depth=1
      git diff --name-only "origin/$BASE_REF"...HEAD > changed_files.txt
      grep -E '(^|/)(Dockerfile|docker-compose\.ya?ml|docker/)' changed_files.txt || true
      if grep -E '(^|/)(Dockerfile|docker-compose\.ya?ml|docker/)' changed_files.txt > /dev/null; then
        echo "changed=true" >> $GITHUB_OUTPUT
      else
        echo "changed=false" >> $GITHUB_OUTPUT
      fi
    shell: bash
